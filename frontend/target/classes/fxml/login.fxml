<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.media.MediaView?>
<?import javafx.scene.shape.Circle?>
<?import java.net.URL?>

<StackPane xmlns:fx="http://javafx.com/fxml" 
           fx:controller="com.ctrlaltquest.ui.controllers.LoginController"
           styleClass="root" prefWidth="1280" prefHeight="720">
    
    <stylesheets>
        <URL value="@/styles/auth.css" />
    </stylesheets>
    
    <MediaView fx:id="backgroundVideo" fitWidth="1280" fitHeight="720" preserveRatio="false" />

    <Region style="-fx-background-color: rgba(13, 9, 21, 0.65);" />

    <BorderPane styleClass="main-container">
        
        <top>
            <HBox alignment="CENTER_RIGHT" spacing="15" styleClass="top-bar" style="-fx-padding: 25;">
                <Button text="âš™" onAction="#handleOpenSettings" 
                        styleClass="icon-button" focusTraversable="false" />
            </HBox>
        </top>
        
        <left>
            <VBox spacing="0" styleClass="sidebar" alignment="TOP_CENTER" prefWidth="420">
                <VBox alignment="CENTER" prefHeight="280" spacing="15">
                    <ImageView fx:id="sidebarLogo" fitHeight="130" preserveRatio="true" />
                    <Label text="CTRL + ALT + QUEST" styleClass="sidebar-title-runic" />
                </VBox>

                <VBox alignment="TOP_CENTER" spacing="25" VBox.vgrow="ALWAYS" style="-fx-padding: 0 40;">
                    <StackPane fx:id="carouselContainer" styleClass="carousel-viewport-clean">
                        <StackPane fx:id="newsSlider">
                            <VBox styleClass="news-card-compact" alignment="TOP_LEFT" spacing="12">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="âœ¦" styleClass="bullet-icon-gold"/>
                                    <Label text="ACTUALIZACIÃ“N" styleClass="card-category-runic" />
                                </HBox>
                                <Label text="Se optimizÃ³ el login para una experiencia mÃ¡s fluida en tu stack productivo." 
                                       wrapText="true" styleClass="card-text-pixel" />
                            </VBox>
                            
                            <VBox styleClass="news-card-compact" alignment="TOP_LEFT" spacing="12" visible="false">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="âš”" styleClass="bullet-icon-gold"/>
                                    <Label text="DESAFÃOS" styleClass="card-category-runic" />
                                </HBox>
                                <Label text="DesafÃ­o de productividad iniciado: automatiza tu workflow esta semana y gana XP extra." 
                                       wrapText="true" styleClass="card-text-pixel" />
                            </VBox>
                        </StackPane>
                    </StackPane>
                    
                    <HBox alignment="CENTER" spacing="12" styleClass="carousel-dots">
                        <Circle radius="5" styleClass="dot, active-dot"/>
                        <Circle radius="5" styleClass="dot"/>
                    </HBox>
                </VBox>
            </VBox>
        </left>

        <center>
            <StackPane>
                <VBox alignment="CENTER" spacing="30" maxWidth="550" maxHeight="580" styleClass="auth-panel">
                    
                    <VBox alignment="CENTER" spacing="10">
                        <Label text="BIENVENIDO USUARIO" styleClass="auth-title-hero" 
                               wrapText="true" textAlignment="CENTER" maxWidth="Infinity" />
                        <Region prefHeight="5" />
                    </VBox>
                    
                    <VBox spacing="25" styleClass="input-group" maxWidth="420">
                        <VBox spacing="8">
                            <Label text="IDENTIDAD" styleClass="input-label-runic-gold"/>
                            <TextField fx:id="usernameField" promptText="Nombre de usuario" styleClass="custom-field" />
                        </VBox>
                        
                        <VBox spacing="8">
                            <Label text="CONTRASEÃ‘A" styleClass="input-label-runic-gold"/>
                            
                            <StackPane>
                                <PasswordField fx:id="passwordHidden" promptText="ContraseÃ±a" 
                                               styleClass="custom-field"
                                               style="-fx-padding: 10 45 10 15;" 
                                               maxWidth="Infinity" />
                                
                                <TextField fx:id="passwordShown" promptText="ContraseÃ±a" 
                                           styleClass="custom-field" 
                                           style="-fx-padding: 10 45 10 15;"
                                           maxWidth="Infinity" visible="false" />
                                
                                <Button fx:id="btnTogglePassword" 
                                        onAction="#togglePassword" 
                                        text="ðŸ‘" 
                                        StackPane.alignment="CENTER_RIGHT"
                                        style="-fx-background-color: transparent; -fx-text-fill: #f7d27a; -fx-cursor: hand; -fx-font-size: 16px; -fx-padding: 0 15 0 0;"
                                        focusTraversable="false" />
                            </StackPane>
                        </VBox>

                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <CheckBox fx:id="rememberMeCheck" styleClass="pixel-checkbox" />
                            <Label text="Recordar mi juramento (contraseÃ±a)" 
                                   styleClass="settings-sublabel" 
                                   style="-fx-text-fill: #b5a7c6; -fx-font-size: 14px;"/>
                        </HBox>
                    </VBox>
                    
                    <Button text="INICIAR AVENTURA" onAction="#handleLogin" 
                            styleClass="primary-button-hero" prefWidth="420" />
                    
                    <HBox alignment="CENTER" spacing="45">
                        <Button text="Crear cuenta" onAction="#handleGoToRegister" 
                                styleClass="link-button-clean" focusTraversable="false" />
                        <Button text="Â¿Olvidaste tu llave?" onAction="#handleForgotPassword" 
                                styleClass="link-button-clean" focusTraversable="false" />
                    </HBox>
                </VBox>

                <VBox fx:id="loadingLayer" visible="false" alignment="CENTER" spacing="20" 
                      style="-fx-background-color: rgba(26, 15, 38, 0.9); -fx-background-radius: 40; 
                             -fx-border-color: #f7d27a; -fx-border-radius: 40; -fx-border-width: 2;"
                      maxWidth="450" maxHeight="300">
                    <ProgressIndicator prefWidth="70" prefHeight="70" />
                    <Label text="Sincronizando con el servidor..." 
                           style="-fx-text-fill: #f7d27a; -fx-font-family: 'Runewood'; -fx-font-size: 18px;" />
                </VBox>
            </StackPane>
        </center>
    </BorderPane>
</StackPane>