<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.shape.Line?>
<?import javafx.scene.effect.DropShadow?>

<ScrollPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.ctrlaltquest.ui.controllers.views.ProfileViewController"
            fitToWidth="true" styleClass="transparent-scroll" stylesheets="@/styles/home.css"
            style="-fx-background: transparent; -fx-background-color: transparent;">

    <VBox spacing="35" style="-fx-background-color: transparent;">
        <padding><Insets top="30" right="50" bottom="50" left="50"/></padding>

        <HBox spacing="25" alignment="CENTER_LEFT" styleClass="activity-card" style="-fx-padding: 25;">
            <effect>
                <DropShadow color="rgba(0,0,0,0.6)" radius="20" offsetY="5"/>
            </effect>
            
            <StackPane>
                <StackPane style="-fx-border-color: #f7d27a; -fx-border-radius: 50%; -fx-border-width: 3; -fx-padding: 5;">
                    <ImageView fx:id="imgAvatar" fitHeight="100" fitWidth="100" preserveRatio="true" smooth="true"/>
                </StackPane>
                <Label text="LVL 1" style="-fx-background-color: #2c1a4d; -fx-text-fill: #f7d27a; -fx-font-weight: bold; -fx-padding: 2 8; -fx-background-radius: 10; -fx-border-color: #f7d27a; -fx-border-radius: 10;" StackPane.alignment="BOTTOM_CENTER" translateY="10"/>
            </StackPane>

            <VBox spacing="8">
                <Label fx:id="lblUsernameHeader" text="CARGANDO..." styleClass="hero-name" style="-fx-font-size: 28px;"/>
                <Label fx:id="lblEmailHeader" text="usuario@email.com" styleClass="text-tiny-bright" style="-fx-font-size: 14px; -fx-opacity: 0.8;"/>
                <Label text="Miembro del Gremio desde 2026" styleClass="text-tiny" style="-fx-text-fill: #b5a7c6;"/>
            </VBox>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Button text="Cambiar Retrato" styleClass="btn-nav" style="-fx-font-size: 12px;"/>
        </HBox>

        <VBox spacing="15">
            <Label text="CREDENCIALES" styleClass="section-title-small" style="-fx-text-fill: #f7d27a;"/>
            
            <GridPane vgap="20" hgap="20" styleClass="activity-card" style="-fx-padding: 25;">
                <columnConstraints>
                    <ColumnConstraints minWidth="120" halignment="RIGHT"/>
                    <ColumnConstraints hgrow="ALWAYS"/>
                </columnConstraints>

                <Label text="Nombre Clave:" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="text-tiny-bright" style="-fx-font-size: 13px;"/>
                <TextField fx:id="txtUsername" GridPane.rowIndex="0" GridPane.columnIndex="1" styleClass="input-field" promptText="Tu nombre pÃºblico"/>

                <Label text="Correo:" GridPane.rowIndex="1" GridPane.columnIndex="0" styleClass="text-tiny-bright" style="-fx-font-size: 13px;"/>
                <TextField fx:id="txtEmail" editable="false" opacity="0.6" GridPane.rowIndex="1" GridPane.columnIndex="1" styleClass="input-field" text="usuario@email.com"/>
                
                <Button text="GUARDAR CAMBIOS" onAction="#handleSaveProfile" styleClass="btn-action-primary" GridPane.rowIndex="2" GridPane.columnIndex="1" GridPane.halignment="RIGHT"/>
            </GridPane>
        </VBox>

        <VBox spacing="15">
            <Label text="PROTOCOLOS DE SEGURIDAD" styleClass="section-title-small" style="-fx-text-fill: #f7d27a;"/>
            
            <GridPane vgap="20" hgap="20" styleClass="activity-card" style="-fx-padding: 25;">
                <columnConstraints>
                    <ColumnConstraints minWidth="120" halignment="RIGHT"/>
                    <ColumnConstraints hgrow="ALWAYS"/>
                </columnConstraints>

                <Label text="Nueva Llave:" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="text-tiny-bright" style="-fx-font-size: 13px;"/>
                <PasswordField fx:id="txtNewPass" GridPane.rowIndex="0" GridPane.columnIndex="1" styleClass="input-field" promptText="MÃ­nimo 6 caracteres"/>

                <Label text="Confirmar:" GridPane.rowIndex="1" GridPane.columnIndex="0" styleClass="text-tiny-bright" style="-fx-font-size: 13px;"/>
                <PasswordField fx:id="txtConfirmPass" GridPane.rowIndex="1" GridPane.columnIndex="1" styleClass="input-field" promptText="Repite la nueva llave"/>
                
                <Button text="ACTUALIZAR CONTRASEÃ‘A" onAction="#handleChangePassword" styleClass="btn-nav" GridPane.rowIndex="2" GridPane.columnIndex="1" GridPane.halignment="RIGHT" style="-fx-border-color: #f7d27a;"/>
            </GridPane>
        </VBox>

        <HBox spacing="30">
            <VBox spacing="15" HBox.hgrow="ALWAYS">
                <Label text="ARCHIVOS DEL SISTEMA" styleClass="section-title-small" style="-fx-text-fill: #4ade80;"/>
                <VBox spacing="15" styleClass="activity-card" style="-fx-padding: 20;" VBox.vgrow="ALWAYS">
                    <Label text="Descarga una copia local de tu historial de misiones y actividad." styleClass="text-tiny" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox spacing="15">
                        <Button text="ðŸ“„ CSV" onAction="#handleExportCSV" styleClass="btn-nav" maxWidth="Infinity" HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ“Š PDF" onAction="#handleExportPDF" styleClass="btn-nav" maxWidth="Infinity" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>
            </VBox>

            <VBox spacing="15" HBox.hgrow="ALWAYS">
                <Label text="ZONA DE PELIGRO" styleClass="section-title-small" style="-fx-text-fill: #ff4444;"/>
                <VBox spacing="15" style="-fx-border-color: rgba(255, 68, 68, 0.4); -fx-border-radius: 12; -fx-background-color: rgba(45, 10, 10, 0.4); -fx-padding: 20;" VBox.vgrow="ALWAYS">
                    <effect><DropShadow color="rgba(255, 68, 68, 0.1)" radius="15"/></effect>
                    <Label text="Esta acciÃ³n borrarÃ¡ permanentemente tu usuario y progreso." styleClass="text-tiny" wrapText="true" style="-fx-text-fill: #ffaaaa;"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <Button text="ELIMINAR CUENTA" onAction="#handleDeleteAccount" styleClass="btn-nav-danger" maxWidth="Infinity" style="-fx-alignment: CENTER; -fx-border-color: #ff4444;"/>
                </VBox>
            </VBox>
        </HBox>

    </VBox>
</ScrollPane>