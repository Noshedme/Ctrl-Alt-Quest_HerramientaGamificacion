<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.shape.Line?>
<?import javafx.scene.media.MediaView?>
<?import java.net.URL?>

<StackPane fx:id="rootContainer" xmlns:fx="http://javafx.com/fxml" 
           fx:controller="com.ctrlaltquest.ui.controllers.CharacterEditorController"
           styleClass="root" prefWidth="1280" prefHeight="720">
    
    <stylesheets>
        <URL value="@/styles/auth.css" />
        <URL value="@/styles/character_editor.css" />
    </stylesheets>

    <MediaView fx:id="bgMedia" fitWidth="1280" fitHeight="720" preserveRatio="false" />
    <Region style="-fx-background-color: rgba(13, 9, 21, 0.85);" />

    <BorderPane>
        <top>
            <HBox alignment="CENTER_RIGHT" style="-fx-padding: 25;">
                <Button text="⚙" onAction="#handleOpenSettings" styleClass="icon-button" focusTraversable="false" />
            </HBox>
        </top>
        
        <center>
            <HBox spacing="60" alignment="CENTER">
                
                <VBox spacing="25" alignment="CENTER_LEFT" prefWidth="480">
                    <VBox spacing="5">
                        <Label text="EDITOR DE PERFIL TECH" styleClass="auth-title-hero" />
                        <Label text="Diseña tu avatar digital" styleClass="settings-sublabel" />
                    </VBox>

                    <VBox styleClass="settings-pane" spacing="25">
                        <VBox spacing="8">
                            <Label text="NOMBRE DEL AVATAR" styleClass="settings-label" />
                            <TextField fx:id="nameField" styleClass="custom-field" promptText="Ej. CodeWarrior..." />
                        </VBox>

                        <HBox spacing="20">
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="GÉNERO" styleClass="settings-label" />
                                <HBox spacing="5">
                                    <ToggleButton text="M" fx:id="toggleMale" onAction="#setMale" styleClass="toggle-rpg" prefWidth="60"/>
                                    <ToggleButton text="F" fx:id="toggleFemale" onAction="#setFemale" selected="true" styleClass="toggle-rpg" prefWidth="60"/>
                                </HBox>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="CLASE (ROL)" styleClass="settings-label" />
                                <ChoiceBox fx:id="classSelector" prefWidth="200" styleClass="custom-choice-box" />
                            </VBox>
                        </HBox>

                        <Line endX="400" styleClass="settings-divider" />

                        <VBox spacing="15">
                            <Label text="APARIENCIA &amp; EQUIPO" styleClass="settings-label" />
                            
                            <HBox alignment="CENTER" spacing="15" style="-fx-background-color: rgba(0,0,0,0.2); -fx-padding: 10; -fx-background-radius: 8;">
                                <Button text="◀" onAction="#prevSkin" styleClass="arrow-button" />
                                
                                <VBox alignment="CENTER" prefWidth="250">
                                    <Label fx:id="lblSkinName" text="BASE" alignment="CENTER" styleClass="item-name-label" style="-fx-font-size: 16px;"/>
                                    <Label text="Set Completo" style="-fx-text-fill: #888; -fx-font-size: 10px;"/>
                                </VBox>
                                
                                <Button text="▶" onAction="#nextSkin" styleClass="arrow-button" />
                            </HBox>
                        </VBox>

                        <Line endX="400" styleClass="settings-divider" />

                        <VBox spacing="15" alignment="CENTER">
                            <Button text="CONFIRMAR PERSONAJE" onAction="#handleSave" styleClass="primary-button-hero" prefWidth="400" />
                            <Button text="CANCELAR" onAction="#handleCancel" styleClass="link-button-clean" />
                        </VBox>
                    </VBox>
                </VBox>

                <VBox alignment="CENTER" spacing="20">
                    <StackPane fx:id="spritePreview" styleClass="auth-panel" prefWidth="420" prefHeight="550" 
                               style="-fx-effect: dropshadow(three-pass-box, rgba(163, 53, 238, 0.4), 30, 0, 0, 0);">
                        
                        <ImageView fitHeight="400" preserveRatio="true" opacity="0.1">
                            </ImageView>

                        <ImageView fx:id="fullCharacterView" fitHeight="420" preserveRatio="true" smooth="false" pickOnBounds="false" />
                    </StackPane>
                    
                    <VBox alignment="CENTER" spacing="5">
                        <Label text="VISTA PREVIA" styleClass="card-category-runic" />
                        <Label text="Nivel 1 - Principiante" styleClass="card-text-pixel" />
                    </VBox>
                </VBox>

            </HBox>
        </center>
    </BorderPane>
</StackPane>